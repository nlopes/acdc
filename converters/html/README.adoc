# `acdc-converters-html`

HTML converter for `AsciiDoc` documents. This is the default backend for `acdc`.

## Usage

[source,console]
....
acdc convert document.adoc
....

This generates `document.html` in the same directory as the source file.

You can also convert multiple files at once:

[source,console]
....
acdc convert *.adoc
....

Or convert from stdin to stdout:

[source,console]
....
cat document.adoc | acdc convert --stdin
....

## Features

### Standalone HTML Output

Generates complete, standalone HTML documents with embedded CSS. No external dependencies needed - the output file contains everything required for display.

### Asciidoctor-Compatible Styling

Uses the same CSS as Asciidoctor for familiar, professional-looking output. The embedded stylesheet provides:

- Clean, readable typography
- Responsive layout
- Syntax highlighting support
- Print-optimized styles

### Full AsciiDoc Support

Supports all major AsciiDoc constructs:

- **Document structure**: Headers, sections, table of contents
- **Text formatting**: Bold, italic, monospace, highlighting, subscript, superscript
- **Lists**: Unordered, ordered, description lists, callout lists
- **Blocks**: Listings, literals, examples, quotes, sidebars, open blocks
- **Admonitions**: NOTE, TIP, IMPORTANT, WARNING, CAUTION (with Font Awesome icons when `:icons: font`)
- **Media**: Images, videos (YouTube, Vimeo), audio
- **Tables**: Full table support with headers, footers, cell formatting, cell spanning, and nested tables
- **Cross-references**: Internal links and anchors
- **Attributes**: Document-level attribute substitution
- **Index terms**: Visible `((term))` and concealed `(((term,secondary,tertiary)))` with catalog generation

### Section Numbering

Documents with `:sectnums:` render numbered section headings (e.g., "1. Introduction", "1.1. Overview"). Control numbering depth with `:secnumlevels:` (default 3, max 5).

[source,console]
....
acdc convert -a sectnums -a secnumlevels=2 document.adoc
....

Table of contents entries are also numbered when `:sectnums:` is set.

### Syntax Highlighting

Source blocks with a language specified render with syntax highlighting (requires the `highlighting` feature flag). Uses syntect with inline CSS styles.

[source,console]
....
cargo build --features highlighting
acdc convert document.adoc
....

Falls back to plain text when the language isn't recognized.

### Stylesheets

The HTML converter handles CSS output through document attributes, matching https://docs.asciidoctor.org/asciidoctor/latest/html-backend/stylesheet-modes/[Asciidoctor's stylesheet modes]. By default, CSS is embedded directly in the HTML `<style>` tag — no external files needed.

NOTE: Stylesheet handling only applies to standalone HTML output. In embedded mode (`acdc convert --embedded`), the `<head>` element is not generated, so stylesheet attributes have no effect on the output. `copycss` is also skipped.

#### Default (embedded CSS)

Out of the box, acdc embeds the full stylesheet and links Google Fonts:

[source,console]
....
acdc convert document.adoc
....

The output is self-contained — one HTML file with everything included.

#### External stylesheet (`:linkcss:`)

Set `:linkcss:` to reference CSS via a `<link>` tag instead of embedding it. The built-in stylesheet is automatically written to disk next to the HTML output (see https://docs.asciidoctor.org/asciidoctor/latest/html-backend/stylesheet-modes/#link-mode[link mode]):

[source,console]
....
acdc convert -a linkcss document.adoc
....

Or in the document header:

[source,asciidoc]
....
= My Document
:linkcss:
....

This produces a `<link rel="stylesheet" href="./asciidoctor-light-mode.css">` in the HTML and copies the CSS file alongside the output.

#### Custom stylesheet (`:stylesheet:`)

Point to your own CSS file with `:stylesheet:`. When combined with `:linkcss:`, it links to the file. Without `:linkcss:`, the file is read from disk and embedded (see https://docs.asciidoctor.org/asciidoctor/latest/html-backend/stylesheet-modes/#custom[custom stylesheet]):

[source,console]
....
# Embed custom CSS
acdc convert -a stylesheet=custom.css document.adoc

# Link to custom CSS
acdc convert -a linkcss -a stylesheet=custom.css document.adoc
....

The converter looks for the file relative to `:stylesdir:` (default: `.`) and the source document directory. If the file can't be read, it falls back to the built-in stylesheet.

#### No stylesheet (`:!stylesheet:`)

Suppress all CSS and webfont output entirely (see https://docs.asciidoctor.org/asciidoctor/latest/html-backend/stylesheet-modes/#disable[disable mode]):

[source,console]
....
acdc convert -a stylesheet! document.adoc
....

Or in the document:

[source,asciidoc]
....
= My Document
:!stylesheet:
....

No `<style>` block, no `<link>` tags for CSS or fonts — just raw HTML.

#### Styles directory (`:stylesdir:`)

Controls where stylesheet references point and where copies are written (see https://docs.asciidoctor.org/asciidoctor/latest/html-backend/manage-images/#stylesdir[stylesdir]):

[source,console]
....
acdc convert -a linkcss -a stylesdir=css document.adoc
....

Produces `<link rel="stylesheet" href="css/asciidoctor-light-mode.css">` and writes the CSS to `css/`.

#### Copy CSS (`:copycss:`)

When `:linkcss:` is set, `:copycss:` controls whether the stylesheet is written to the output directory. It's enabled by default. A non-empty value overrides the source path — useful when the CSS lives somewhere other than `:stylesdir:` (see https://docs.asciidoctor.org/asciidoctor/latest/html-backend/manage-images/#copycss[copycss]):

[source,console]
....
# Copy from a custom location
acdc convert -a linkcss -a copycss=/path/to/source.css document.adoc
....

#### Webfonts (`:webfonts:`)

By default, the converter links Google Fonts (Open Sans, Noto Serif, Droid Sans Mono). You can customize or disable this (see https://docs.asciidoctor.org/asciidoctor/latest/html-backend/default-stylesheet/#webfonts[webfonts]):

[source,console]
....
# Disable webfonts
acdc convert -a webfonts! document.adoc

# Custom font families
acdc convert -a "webfonts=Roboto:400,700|Fira+Code:400" document.adoc
....

Webfonts are suppressed automatically when `:!stylesheet:` is set.

#### Dark mode

Set `:dark-mode:` to use the dark variant of the built-in stylesheet. This adds a `<meta name="color-scheme" content="dark">` tag and uses `asciidoctor-dark-mode.css` (or `html5s-dark-mode.css` for the semantic backend):

[source,console]
....
acdc convert -a dark-mode document.adoc
....

#### Syntax highlighting CSS

When using class-based syntax highlighting (`:syntect-css: class`), the highlighting CSS is handled the same way — embedded by default, or linked/written to disk when `:linkcss:` is set. See the <<Syntax Highlighting>> section above.

### Table Enhancements

Full table feature support:

- **Cell spanning**: colspan (`2+|`), rowspan (`.2+|`), combined (`2.3+|`)
- **Visual attributes**: `frame`, `grid`, `stripes`, `width`, `%autowidth`
- **Nested tables**: Using `!===` delimiter in AsciiDoc cells
- **Cell-level formatting**: Alignment, styles (strong, emphasis, monospace, etc.)

### Substitution Control

Verbatim blocks (listing, literal) support the `subs` attribute:

- `subs=none` - disable all substitutions, output raw content
- `subs=+quotes` - enable inline formatting in code blocks
- `subs=+attributes` - enable attribute expansion
- `subs=+replacements` - enable typography (arrows, dashes, ellipsis)

### Mathematical Formulas (Stem)

Render mathematical formulas using MathJax 4. Enable it by setting the `:stem:` document attribute.

[source,asciidoc]
....
= My Document
:stem: latexmath
....

The `:stem:` attribute accepts:

- `latexmath` - use LaTeX notation
- `asciimath` - use AsciiMath notation
- _(empty)_ - defaults to `latexmath` for blocks, `asciimath` for inline

**Inline formulas** use the `stem:[]` macro:

[source,asciidoc]
....
The solution is stem:[x = (-b +- sqrt(b^2 - 4ac)) / (2a)].
....

**Block formulas** use the `[stem]` attribute on a passthrough block:

[source,asciidoc]
....
[stem]
++++
x = (-b +- sqrt(b^2 - 4ac)) / (2a)
++++
....

When enabled, MathJax is loaded from the jsdelivr CDN (`cdn.jsdelivr.net/npm/mathjax@4`) and renders formulas client-side. LaTeX uses `\(...\)` and `\[...\]` delimiters; AsciiMath uses `\$...\$`.

To suppress MathJax processing on specific elements, add the CSS class `nostem`, `nolatexmath`, or `noasciimath`.

### Semantic HTML5 Output (`html5s`)

An alternative backend that produces semantic HTML5 instead of the traditional div-based layout, inspired by Jakub Jirutka's https://github.com/jirutka/asciidoctor-html5s[asciidoctor-html5s] gem for Asciidoctor. Enable it with `--backend html5s`:

[source,console]
....
acdc convert --backend html5s document.adoc
....

Key differences from the standard backend:

- **Sections** use `<section>` elements instead of `<div class="sectN">`
- **Admonitions** use `<aside>` (note, tip) or `<section>` (warning, important, caution) with ARIA roles
- **Images** use `<figure>` and `<figcaption>` instead of `<div class="imageblock">`
- **Example blocks** use `<figure>` instead of `<div class="exampleblock">`
- **Sidebars** use `<aside>` instead of `<div class="sidebarblock">`
- **Callout lists** use `<ol>` instead of a table layout
- **Titled paragraphs** are wrapped in `<section>` with `<h6 class="block-title">`
- **Block titles** use `<h6 class="block-title">` instead of `<div class="title">`

The semantic variant ships with its own stylesheet (light and dark mode) and supports a few additional document attributes:

- `:html5s-force-stem-type:` — override the stem notation (`latexmath` or `asciimath`) regardless of the `:stem:` value
- `:html5s-image-default-link: self` — make all images link to themselves by default
- `:html5s-image-self-link-label:` — custom aria label for self-linked images (default: "Open the image in full size")

### Document Attributes

Set document attributes via command line:

[source,console]
....
acdc convert -a toc=left -a toclevels=3 -a icons=font document.adoc
....

### Performance Timing

Enable timing information to see conversion performance:

[source,console]
....
acdc convert --timings document.adoc
....

Output:
....
Input file: document.adoc
  Time to convert document: 12.5ms
Generated HTML file: document.html
....

## Output Structure

Generated HTML includes:

- Complete HTML5 document structure
- Embedded CSS for styling
- Metadata (generator, last updated timestamp)
- Table of contents (if enabled via `:toc:` attribute)
- Semantic HTML elements matching AsciiDoc structure

## Examples

### Basic Conversion

[source,console]
....
acdc convert README.adoc
....

### With Table of Contents

[source,console]
....
acdc convert -a toc=left -a toclevels=2 guide.adoc
....

### Book Doctype

[source,console]
....
acdc convert --doctype book -a toc book.adoc
....

### Safe Mode

[source,console]
....
acdc convert --safe-mode safe document.adoc
....

## Technical Details

The HTML converter:

- Generates valid HTML5
- Preserves source line information for debugging
- Handles Unicode correctly
- Auto-numbers example blocks
- Generates unique IDs for sections and anchors
- Embeds the Asciidoctor CSS stylesheet for consistent styling
- Includes file modification timestamps in metadata

## Differences from Asciidoctor

While the HTML converter aims for compatibility with Asciidoctor, there are some known differences and limitations.

- The `css-signature` attribute is not supported. Use a document ID instead (`[[my-id]]` above the title).
- Syntax highlighting uses syntect with inline CSS styles rather than external highlight.js or Pygments. Language coverage may differ.
- The `html5s` backend is inspired by Jakub Jirutka's https://github.com/jirutka/asciidoctor-html5s[asciidoctor-html5s] gem but is a separate implementation with its own output.
